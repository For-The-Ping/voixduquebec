<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voix du Québec — Élection provinciale</title>
  <meta name="theme-color" content="#0B57D0" />
  <link rel="stylesheet" href="/styles.css" />
  <script defer src="/vendor/chart.umd.js"></script>
  <!-- Turnstile (optionnel) -->
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  <script defer src="/app.js"></script>
</head>
<body>
  <header class="md-appbar elevation-3">
    <div class="md-appbar__inner">
      <div class="md-brand">
        <img src="https://upload.wikimedia.org/wikipedia/commons/5/5f/Flag_of_Quebec.svg" alt="QC" class="qc-flag" />
        <div class="md-brand__text">
          <div class="md-title">Voix du Québec</div>
          <div class="md-subtitle">Élection provinciale — <span class="election-date">5 octobre 2026</span></div>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="md-grid">
      <article class="md-card elevation-2 chart-card">
        <canvas id="chart" width="460" height="460"></canvas>
        <div id="center-label" class="center-label"></div>
      </article>

      <aside class="md-card elevation-2 vote-card">
        <form id="vote-form" class="form">
          <div id="candidate-list" class="candidate-list"></div>

          <!-- Vérification email (OTP) -->
          <div class="otp-block">
            <label class="label">Votre courriel (pour 1 personne = 1 vote) :</label>
            <div class="otp-row">
              <input id="email" type="email" placeholder="votre@email"
                     class="input" autocomplete="email" />
              <button id="otp-send" type="button" class="md-button">Envoyer code</button>
            </div>
            <div class="otp-row">
              <input id="otp-code" type="text" inputmode="numeric" pattern="[0-9]*"
                     placeholder="Code à 6 chiffres" class="input small" />
              <button id="otp-verify" type="button" class="md-button">Vérifier</button>
              <span id="otp-status" class="caption muted"></span>
            </div>
          </div>

          <div class="push"></div>

        <div class="oauth-row">
  <button type="button" class="md-button" onclick="location.href='/auth/google'">Se connecter avec Google</button>
  <button type="button" class="md-button" onclick="location.href='/auth/microsoft'">Se connecter avec Microsoft</button>
  <button type="button" class="md-button" id="logout-btn">Se déconnecter</button>
  <span id="auth-status" class="caption muted"></span>
</div>

          <button type="submit" class="md-button md-button--filled ripple vote-btn">
            <span class="md-button__label">Voter</span>
          </button>
          <p id="msg" class="caption muted"></p>
        </form>
        <details class="expando">
          <summary>Pourquoi ces limites ?</summary>
          <p class="body">Email (ou session), preuve de travail, captcha et quotas IP pour limiter le spam. Politique REPLACE : on peut changer d’avis.</p>
        </details>
      </aside>
    </section>

    <section class="md-card elevation-2 results-card">
      <h2 class="section-title">Résultats en direct</h2>
      <div id="results-table"></div>
      <p class="caption muted end-note">Projet citoyen, non scientifique.</p>
    </section>
  </main>

  <footer class="footer">
    <p class="caption muted">© Voix du Québec</p>
  </footer>
</body>
</html>
