<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voix du Québec — Élection provinciale</title>
  <meta name="theme-color" content="#0B57D0" />
  <link rel="stylesheet" href="/styles.css" />
  <script defer src="/vendor/chart.umd.js"></script>

  <!-- (Optionnel) Cloudflare Turnstile ; laisse si non utilisé -->
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

  <script defer src="/app.js"></script>
</head>
<body>
  <header class="md-appbar elevation-3">
    <div class="md-appbar__inner">
      <div class="md-brand">
        <img src="https://upload.wikimedia.org/wikipedia/commons/5/5f/Flag_of_Quebec.svg" alt="QC" class="qc-flag" />
        <div class="md-brand__text">
          <div class="md-title">Voix du Québec</div>
          <div class="md-subtitle">Élection provinciale — <span class="election-date">5 octobre 2026</span></div>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="md-grid">
      <article class="md-card elevation-2 chart-card">
        <canvas id="chart" width="460" height="460"></canvas>
        <div id="center-label" class="center-label"></div>
      </article>

      <aside class="md-card elevation-2 vote-card">
        <form id="vote-form" class="form">
          <div id="candidate-list" class="candidate-list"></div>

          <!-- Connexion OAuth -->
        <div class="auth-actions">
          <button id="loginBtn" class="btn primary">Se connecter avec Google</button>
          <button id="logoutBtn" class="btn outline">Se déconnecter</button>
          <p class="auth-hint" data-auth-hint>Connexion requise pour voter</p>
        </div>

          <div class="push"></div>

          <!-- Turnstile (optionnel, remplace SITE_KEY si tu l’utilises) -->
          <div class="cf-turnstile" data-sitekey="SITE_KEY" data-theme="auto" data-size="flexible"></div>

          <button type="submit" class="md-button md-button--filled ripple vote-btn">
            <span class="md-button__label">Voter</span>
          </button>
          <p id="msg" class="caption muted"></p>
        </form>
        <details class="why-connect" open>
          <summary>Pourquoi la connexion Google&nbsp;?</summary>
          <div class="why-content">
            <p>
              Se connecter avec Google nous aide à empêcher le spam et la fraude
              sans inscription compliquée ni numéro de téléphone.
            </p>
            <ul>
              <li><strong>Un vote par personne</strong> : OAuth limite les doublons et bloque les robots.</li>
              <li><strong>Vie privée</strong> : on ne lit pas vos courriels et on ne publie rien ; on stocke seulement un identifiant <em>haché</em> pour valider l’unicité.</li>
              <li><strong>Transparence</strong> : code et méthodologie ouverts à l’audit.</li>
              <li><strong>Coûts réduits</strong> : pas d’SMS ni d’infra anti‑bot lourde → service durable.</li>
              <li><strong>Conforme Loi 25</strong> : collecte minimale, finalité claire, conservation limitée.</li>
            </ul>
          </div>
        </details>
      </aside>
    </section>

    <section class="md-card elevation-2 results-card">
      <h2 class="section-title">Résultats en direct</h2>
      <div id="results-table"></div>
      <p class="caption muted end-note">Projet citoyen, non scientifique.</p>
    </section>
  </main>

  <footer class="footer">
    <p class="caption muted">© Voix du Québec</p>
  </footer>
</body>
</html>
